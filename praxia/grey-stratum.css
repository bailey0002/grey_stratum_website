/* ============================================
   GREY STRATUM DESIGN SYSTEM
   Praxia-1 | Cadencia Protocol
   
   Real expertise. Unreal intelligence.â„¢
   ============================================ */

/* ----------------------------------------
   1. CSS CUSTOM PROPERTIES (TOKENS)
   ---------------------------------------- */

:root,
[data-theme="dark"] {
  --bg-primary: #1A1D21;
  --bg-secondary: #22272E;
  --bg-card: #2D333B;
  --bg-elevated: #363D47;
  --text-primary: #E6EDF3;
  --text-secondary: #768390;
  --text-muted: #545D68;
  --accent: #5BA4B5;
  --accent-hover: #4A8A99;
  --accent-glow: rgba(91, 164, 181, 0.3);
  --accent-subtle: rgba(91, 164, 181, 0.1);
  --status-confirmed: #4CAF50;
  --status-failed: #E05252;
  --status-warning: #E9A84A;
  --status-pending: #768390;
  --border: #3D444D;
  --border-subtle: #2D333B;
  --divider: #3D444D;
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.2);
  --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.2);
  --shadow-card: 0 4px 12px rgba(0, 0, 0, 0.3);
  --shadow-elevated: 0 8px 24px rgba(0, 0, 0, 0.4);
  --shadow-glow: 0 0 0 2px rgba(91, 164, 181, 0.3);
  --shadow-glow-strong: 0 0 12px rgba(91, 164, 181, 0.4);
  --theme-label: "NOX";
}

[data-theme="light"] {
  --bg-primary: #FFFFFF;
  --bg-secondary: #F0F2F4;
  --bg-card: #FFFFFF;
  --bg-elevated: #F8F9FA;
  --text-primary: #1A1D21;
  --text-secondary: #4A4F54;
  --text-muted: #768390;
  --accent: #5BA4B5;
  --accent-hover: #4A8A99;
  --accent-glow: rgba(91, 164, 181, 0.2);
  --accent-subtle: rgba(91, 164, 181, 0.08);
  --border: #D0D7DE;
  --border-subtle: #E8EDF2;
  --divider: #D0D7DE;
  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.05);
  --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.06);
  --shadow-card: 0 4px 12px rgba(0, 0, 0, 0.08);
  --shadow-elevated: 0 8px 24px rgba(0, 0, 0, 0.12);
  --shadow-glow: 0 0 0 2px rgba(91, 164, 181, 0.25);
  --theme-label: "LUX";
}

:root {
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 3rem;
  --radius-sm: 4px;
  --radius-md: 6px;
  --radius-lg: 8px;
  --radius-xl: 12px;
  --radius-full: 9999px;
  --transition-fast: 150ms ease;
  --transition-base: 200ms ease;
  --transition-slow: 300ms ease;
  --transition-emphasis: 400ms ease;
  --z-base: 0;
  --z-elevated: 10;
  --z-sticky: 50;
  --z-header: 100;
  --z-modal: 200;
  --z-toast: 300;
  --container-max: 600px;
  --header-height: 72px;
  --nav-height: 64px;
}

/* ----------------------------------------
   2. RESET & BASE
   ---------------------------------------- */

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html { font-size: 16px; background-color: var(--bg-primary); -webkit-text-size-adjust: 100%; }
body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  font-weight: 300;
  background: var(--bg-primary);
  color: var(--text-primary);
  min-height: 100vh;
  min-height: 100dvh;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color var(--transition-slow), color var(--transition-slow);
}

/* ----------------------------------------
   3. TYPOGRAPHY
   ---------------------------------------- */

.text-display, .page-title, .modal-title, .respiro-title, .stat-value, .timer-time {
  font-family: 'Archivo', sans-serif;
  font-weight: 300;
  letter-spacing: 0.15em;
  text-transform: uppercase;
}

.page-title { font-size: 1.5rem; color: var(--text-primary); margin-bottom: var(--space-xs); }
.page-subtitle { font-size: 0.9375rem; font-weight: 300; color: var(--text-secondary); margin-bottom: var(--space-lg); }

.text-mono, .section-label, .form-label, .toggle-btn, .btn, .stat-label, .timer-label,
.skill-prompt-label, .gauge-label, .protocol-script-label, .nav-item, .back-btn,
.logo-protocol, .theme-label, .state-word {
  font-family: 'Fira Code', 'Consolas', monospace;
  font-weight: 400;
}

.section-label { font-size: 0.6875rem; letter-spacing: 0.15em; color: var(--text-muted); text-transform: uppercase; margin-bottom: var(--space-sm); }
.text-body { font-family: 'Inter', sans-serif; font-weight: 300; font-size: 0.9375rem; line-height: 1.6; }

/* ----------------------------------------
   4. LAYOUT
   ---------------------------------------- */

.app-container { max-width: var(--container-max); margin: 0 auto; min-height: 100vh; min-height: 100dvh; background: var(--bg-primary); position: relative; }
@media (min-width: 768px) { .app-container { max-width: 680px; } }
@media (min-width: 1024px) { .app-container { max-width: 760px; } }
.main-content { padding: var(--space-lg); padding-bottom: calc(var(--nav-height) + var(--space-xl)); }
.view { display: none; animation: fadeIn var(--transition-slow) ease; }
.view.active { display: block; }

@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

/* ----------------------------------------
   5. HEADER
   ---------------------------------------- */

.header { background: var(--bg-secondary); padding: 1.25rem var(--space-lg); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: var(--z-header); }
.header-content { display: flex; align-items: center; justify-content: space-between; gap: var(--space-sm); flex-wrap: wrap; }
.logo { display: flex; align-items: center; gap: var(--space-sm); }
.logo-text { display: flex; flex-direction: column; }
.logo-title { font-family: 'Archivo', sans-serif; font-size: 1.25rem; font-weight: 300; letter-spacing: 0.25em; text-transform: uppercase; color: var(--text-primary); }
.logo-protocol { font-size: 0.625rem; letter-spacing: 0.15em; color: var(--text-muted); }
.user-toggle { display: flex; background: var(--bg-card); border-radius: var(--radius-md); padding: 3px; border: 1px solid var(--border); }
.toggle-btn { padding: var(--space-sm) 0.875rem; border: none; background: transparent; font-size: 0.6875rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-muted); cursor: pointer; border-radius: var(--radius-sm); transition: all var(--transition-fast); }
.toggle-btn:hover { color: var(--text-secondary); }
.toggle-btn.active { background: var(--accent); color: var(--bg-primary); }
.theme-toggle { display: flex; align-items: center; gap: var(--space-sm); cursor: pointer; padding: var(--space-sm); border-radius: var(--radius-md); transition: background var(--transition-fast); }
.theme-toggle:hover { background: var(--bg-card); }
.theme-label { font-size: 0.5625rem; letter-spacing: 0.15em; color: var(--text-muted); }

/* ----------------------------------------
   6. GRADUS MARK
   ---------------------------------------- */

.logo-gradus, .gradus-mini, .gradus-large, .gradus-mood, .gradus-scale, .gradus-confirm, .theme-indicator, .nav-icon { display: flex; align-items: center; gap: 3px; }
.gradus-bar { width: 3px; background-color: var(--accent); border-radius: 1.5px; transition: height var(--transition-slow), opacity var(--transition-slow); }
.logo-gradus { height: 1.5rem; }
.logo-gradus .gradus-bar:nth-child(1) { height: 40%; opacity: 0.5; }
.logo-gradus .gradus-bar:nth-child(2) { height: 65%; opacity: 0.75; }
.logo-gradus .gradus-bar:nth-child(3) { height: 90%; opacity: 1; }
[data-theme="light"] .logo-gradus .gradus-bar:nth-child(1) { height: 90%; opacity: 1; }
[data-theme="light"] .logo-gradus .gradus-bar:nth-child(2) { height: 65%; opacity: 0.75; }
[data-theme="light"] .logo-gradus .gradus-bar:nth-child(3) { height: 40%; opacity: 0.5; }

@keyframes gradusIlluminate { 0%, 100% { opacity: 0.4; } 50% { opacity: 1; } }
.logo-gradus.animated .gradus-bar:nth-child(1) { animation: gradusIlluminate 2.4s ease-in-out infinite 0s; }
.logo-gradus.animated .gradus-bar:nth-child(2) { animation: gradusIlluminate 2.4s ease-in-out infinite 0.15s; }
.logo-gradus.animated .gradus-bar:nth-child(3) { animation: gradusIlluminate 2.4s ease-in-out infinite 0.3s; }

.gradus-mini { height: 20px; gap: 2px; }
.gradus-mini .gradus-bar { width: 2px; }
.gradus-mini .gradus-bar:nth-child(1) { height: 8px; }
.gradus-mini .gradus-bar:nth-child(2) { height: 12px; }
.gradus-mini .gradus-bar:nth-child(3) { height: 16px; }

.gradus-large { height: 80px; gap: 6px; }
.gradus-large .gradus-bar { width: 6px; border-radius: 3px; }

.theme-indicator { gap: 2px; }
.theme-indicator .gradus-bar { width: 2px; background: var(--accent); border-radius: 1px; }
.theme-indicator .gradus-bar:nth-child(1) { height: 6px; opacity: 0.5; }
.theme-indicator .gradus-bar:nth-child(2) { height: 10px; opacity: 0.75; }
.theme-indicator .gradus-bar:nth-child(3) { height: 14px; opacity: 1; }
[data-theme="light"] .theme-indicator .gradus-bar:nth-child(1) { height: 14px; opacity: 1; }
[data-theme="light"] .theme-indicator .gradus-bar:nth-child(2) { height: 10px; opacity: 0.75; }
[data-theme="light"] .theme-indicator .gradus-bar:nth-child(3) { height: 6px; opacity: 0.5; }

/* ----------------------------------------
   7. CARDS
   ---------------------------------------- */

.card { background: var(--bg-card); border-radius: var(--radius-lg); padding: 1.25rem; box-shadow: var(--shadow-card); margin-bottom: var(--space-md); border: 1px solid var(--border); transition: all var(--transition-base); }
.card:hover { box-shadow: var(--shadow-glow), var(--shadow-card); }
.card-title { font-family: 'Archivo', sans-serif; font-weight: 400; font-size: 0.875rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-primary); }
.card-subtitle { font-size: 0.8125rem; color: var(--text-secondary); margin-top: var(--space-xs); font-weight: 300; }
.card-icon { width: 40px; height: 40px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; background: var(--bg-elevated); border: 1px solid var(--border); }
.action-card { display: flex; align-items: center; gap: var(--space-md); cursor: pointer; -webkit-tap-highlight-color: transparent; }
.action-card:active { transform: scale(0.98); }
.action-card .card-content { flex: 1; }
.action-card .chevron { color: var(--text-muted); font-size: 1.25rem; transition: color var(--transition-fast); }
.action-card:hover .chevron { color: var(--accent); }

/* ----------------------------------------
   8. BUTTONS
   ---------------------------------------- */

.btn { display: inline-flex; align-items: center; justify-content: center; gap: var(--space-sm); padding: 0.875rem 1.5rem; border: 1px solid transparent; border-radius: var(--radius-md); font-size: 0.75rem; letter-spacing: 0.15em; text-transform: uppercase; cursor: pointer; transition: all var(--transition-base); -webkit-tap-highlight-color: transparent; }
.btn:active { transform: scale(0.96); }
.btn:disabled { opacity: 0.4; cursor: not-allowed; }
.btn-primary { background: var(--accent); color: var(--bg-primary); border-color: var(--accent); }
.btn-primary:hover:not(:disabled) { background: var(--accent-hover); box-shadow: var(--shadow-glow); }
.btn-secondary { background: var(--bg-card); color: var(--text-secondary); border-color: var(--border); }
.btn-secondary:hover:not(:disabled) { border-color: var(--accent); color: var(--accent); }
.btn-ghost { background: transparent; color: var(--text-muted); padding: var(--space-sm) var(--space-sm); }
.btn-ghost:hover:not(:disabled) { color: var(--accent); }
.btn-danger { background: var(--status-failed); color: var(--text-primary); border-color: var(--status-failed); }
.btn-large { padding: 1rem 2rem; font-size: 0.8125rem; }
.btn-block { width: 100%; }
.back-btn { display: inline-flex; align-items: center; gap: var(--space-sm); padding: var(--space-sm) 0; background: none; border: none; color: var(--accent); font-size: 0.6875rem; letter-spacing: 0.1em; text-transform: uppercase; cursor: pointer; margin-bottom: var(--space-md); }

/* ----------------------------------------
   9. STATS GRID
   ---------------------------------------- */

.stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-sm); margin-bottom: var(--space-lg); }
.stat-card { background: var(--bg-card); border-radius: var(--radius-lg); padding: var(--space-md); text-align: center; border: 1px solid var(--border); }
.stat-value { font-size: 1.75rem; color: var(--accent); line-height: 1.2; }
.stat-label { font-size: 0.625rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-top: var(--space-xs); }

/* ----------------------------------------
   10. TIMER
   ---------------------------------------- */

.timer-container { display: flex; flex-direction: column; align-items: center; padding: var(--space-xl) 0; }
.timer-ring { position: relative; width: 200px; height: 200px; }
.timer-ring svg { transform: rotate(-90deg); width: 100%; height: 100%; }
.timer-ring-bg { fill: none; stroke: var(--border); stroke-width: 8; }
.timer-ring-progress { fill: none; stroke: var(--accent); stroke-width: 8; stroke-linecap: round; stroke-dasharray: 565; stroke-dashoffset: 0; transition: stroke-dashoffset 1s linear; filter: drop-shadow(0 0 6px var(--accent-glow)); }
.timer-display { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
.timer-time { font-size: 2.5rem; letter-spacing: 0.1em; color: var(--text-primary); }
.timer-label { font-size: 0.625rem; letter-spacing: 0.15em; text-transform: uppercase; color: var(--text-muted); margin-top: var(--space-sm); }

/* ----------------------------------------
   11. SKILL PROMPT
   ---------------------------------------- */

.skill-prompt { background: var(--bg-card); border: 1px solid var(--accent); border-radius: var(--radius-lg); padding: var(--space-lg); margin: var(--space-lg) 0; text-align: center; box-shadow: var(--shadow-glow); }
.skill-prompt-label { font-size: 0.625rem; text-transform: uppercase; letter-spacing: 0.15em; color: var(--accent); margin-bottom: var(--space-sm); }
.skill-prompt-text { font-family: 'Archivo', sans-serif; font-size: 1.25rem; font-weight: 300; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-primary); margin-bottom: var(--space-sm); }
.skill-prompt-hint { font-size: 0.875rem; color: var(--text-secondary); font-style: italic; font-weight: 300; }
.skill-counter { display: flex; align-items: center; justify-content: center; gap: var(--space-lg); margin-top: var(--space-lg); }
.skill-count-btn { width: 48px; height: 48px; border-radius: var(--radius-md); border: 1px solid var(--border); background: var(--bg-card); color: var(--accent); font-size: 1.5rem; cursor: pointer; transition: all var(--transition-base); }
.skill-count-btn:hover { border-color: var(--accent); box-shadow: var(--shadow-glow); }
.skill-count-btn:active { transform: scale(0.95); }
.skill-count-value { font-family: 'Archivo', sans-serif; font-size: 2rem; font-weight: 300; color: var(--accent); min-width: 48px; text-align: center; }

/* ----------------------------------------
   12. GAUGE / THERMOMETER
   ---------------------------------------- */

.gauge-container { padding: var(--space-lg) 0; }
.gauge-track { position: relative; height: 48px; background: linear-gradient(to right, var(--accent) 0%, var(--status-warning) 50%, var(--status-failed) 100%); border-radius: var(--radius-md); margin: var(--space-md) 0; }
.gauge-handle { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 40px; height: 40px; background: var(--bg-card); border-radius: var(--radius-md); box-shadow: var(--shadow-card); cursor: grab; display: flex; align-items: center; justify-content: center; font-family: 'Archivo', sans-serif; font-weight: 400; font-size: 1rem; color: var(--text-primary); border: 2px solid var(--bg-primary); touch-action: none; transition: box-shadow var(--transition-fast); }
.gauge-handle:active { cursor: grabbing; box-shadow: var(--shadow-elevated); }
.gauge-labels { display: flex; justify-content: space-between; padding: 0 var(--space-xs); }
.gauge-label { font-size: 0.625rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-muted); }

/* ----------------------------------------
   13. STATE VOCABULARY
   ---------------------------------------- */

.state-vocabulary { display: flex; flex-wrap: wrap; gap: var(--space-sm); margin: var(--space-md) 0; }
.state-word { padding: var(--space-sm) 0.875rem; background: var(--bg-card); border-radius: var(--radius-md); font-size: 0.6875rem; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-secondary); cursor: pointer; transition: all var(--transition-base); border: 1px solid var(--border); }
.state-word:hover { border-color: var(--accent); color: var(--accent); }
.state-word.selected { background: var(--accent); color: var(--bg-primary); border-color: var(--accent); }

/* ----------------------------------------
   14. RESPIRO
   ---------------------------------------- */

.respiro-step { text-align: center; padding: var(--space-xl) 0; }
.respiro-visual { width: 140px; height: 140px; margin: 0 auto var(--space-xl); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; background: var(--bg-card); border: 1px solid var(--border); transition: all var(--transition-slow); }
.respiro-visual.step-halt { border-color: var(--status-failed); box-shadow: 0 0 20px rgba(224, 82, 82, 0.2); }
.respiro-visual.step-halt .gradus-bar { background: var(--status-failed); }
.respiro-visual.step-retreat { animation: contractVisual 3s ease-in-out infinite; }
.respiro-visual.step-breathe { animation: breatheVisual 4s ease-in-out infinite; }
.respiro-visual.step-reflect { border-color: var(--status-warning); box-shadow: 0 0 20px rgba(233, 168, 74, 0.2); }
.respiro-visual.step-reflect .gradus-bar { background: var(--status-warning); }
.respiro-visual.step-resolve { border-color: var(--status-confirmed); box-shadow: 0 0 20px rgba(76, 175, 80, 0.2); }
.respiro-visual.step-resolve .gradus-bar { background: var(--status-confirmed); }

@keyframes contractVisual { 0%, 100% { transform: scale(1); } 50% { transform: scale(0.85); } }
@keyframes breatheVisual { 0%, 100% { transform: scale(0.9); } 50% { transform: scale(1.1); } }

.respiro-title { font-size: 1.75rem; letter-spacing: 0.25em; color: var(--text-primary); margin-bottom: var(--space-sm); }
.respiro-instruction { font-size: 1rem; font-weight: 300; color: var(--text-secondary); max-width: 280px; margin: 0 auto var(--space-xl); }
.respiro-nav { display: flex; gap: var(--space-md); justify-content: center; }
.respiro-dots { display: flex; gap: var(--space-sm); justify-content: center; margin-bottom: var(--space-lg); }
.respiro-dot { width: 8px; height: 8px; border-radius: var(--radius-full); background: var(--border); transition: all var(--transition-base); }
.respiro-dot.active { background: var(--accent); width: 24px; }

.breathing-pacer { width: 160px; height: 160px; margin: var(--space-xl) auto; border-radius: var(--radius-lg); background: var(--bg-card); border: 2px solid var(--accent); display: flex; align-items: center; justify-content: center; animation: breathePacer 8s ease-in-out infinite; box-shadow: var(--shadow-glow); }
.breathing-pacer-text { font-family: 'Archivo', sans-serif; font-size: 0.875rem; font-weight: 300; letter-spacing: 0.25em; text-transform: uppercase; color: var(--accent); }

@keyframes breathePacer { 0%, 100% { transform: scale(0.8); opacity: 0.6; } 12.5% { transform: scale(1); opacity: 1; } 50% { transform: scale(1); opacity: 1; } 62.5% { transform: scale(0.8); opacity: 0.6; } }

/* ----------------------------------------
   15. URGENTIA
   ---------------------------------------- */

.urgentia-header { background: var(--status-failed); color: var(--text-primary); padding: 1.25rem; border-radius: var(--radius-lg); margin-bottom: var(--space-lg); text-align: center; }
.urgentia-header h2 { font-family: 'Archivo', sans-serif; font-size: 1.25rem; font-weight: 300; letter-spacing: 0.2em; text-transform: uppercase; margin-bottom: var(--space-xs); }
.urgentia-header p { font-size: 0.875rem; font-weight: 300; opacity: 0.9; }
.protocol-scripts { display: flex; flex-direction: column; gap: var(--space-sm); }
.protocol-script { background: var(--bg-card); border-radius: var(--radius-lg); padding: var(--space-md) 1.25rem; border-left: 3px solid var(--accent); }
.protocol-script-label { font-size: 0.625rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-muted); margin-bottom: 0.375rem; }
.protocol-script-text { font-size: 0.9375rem; font-weight: 300; color: var(--text-primary); line-height: 1.5; }

/* ----------------------------------------
   16. MOOD GRID
   ---------------------------------------- */

.filius-mood-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: var(--space-sm); margin: var(--space-xl) 0; }
.mood-btn { aspect-ratio: 1; border: 1px solid var(--border); border-radius: var(--radius-lg); background: var(--bg-card); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all var(--transition-base); }
.mood-btn .gradus-mood { display: flex; align-items: flex-end; gap: 2px; height: 24px; }
.mood-btn .gradus-mood .gradus-bar { width: 3px; border-radius: 1.5px; transition: all var(--transition-base); }
.mood-btn[data-mood="1"] .gradus-bar { background: var(--status-failed); }
.mood-btn[data-mood="1"] .gradus-bar:nth-child(1) { height: 6px; }
.mood-btn[data-mood="1"] .gradus-bar:nth-child(2) { height: 4px; }
.mood-btn[data-mood="1"] .gradus-bar:nth-child(3) { height: 2px; }
.mood-btn[data-mood="2"] .gradus-bar { background: var(--status-warning); }
.mood-btn[data-mood="2"] .gradus-bar:nth-child(1) { height: 8px; }
.mood-btn[data-mood="2"] .gradus-bar:nth-child(2) { height: 6px; }
.mood-btn[data-mood="2"] .gradus-bar:nth-child(3) { height: 4px; }
.mood-btn[data-mood="3"] .gradus-bar { background: var(--text-muted); }
.mood-btn[data-mood="3"] .gradus-bar:nth-child(1) { height: 10px; }
.mood-btn[data-mood="3"] .gradus-bar:nth-child(2) { height: 10px; }
.mood-btn[data-mood="3"] .gradus-bar:nth-child(3) { height: 10px; }
.mood-btn[data-mood="4"] .gradus-bar { background: var(--accent); }
.mood-btn[data-mood="4"] .gradus-bar:nth-child(1) { height: 10px; }
.mood-btn[data-mood="4"] .gradus-bar:nth-child(2) { height: 14px; }
.mood-btn[data-mood="4"] .gradus-bar:nth-child(3) { height: 18px; }
.mood-btn[data-mood="5"] .gradus-bar { background: var(--status-confirmed); }
.mood-btn[data-mood="5"] .gradus-bar:nth-child(1) { height: 14px; }
.mood-btn[data-mood="5"] .gradus-bar:nth-child(2) { height: 18px; }
.mood-btn[data-mood="5"] .gradus-bar:nth-child(3) { height: 22px; }
.mood-btn:active { transform: scale(0.95); }
.mood-btn.selected { border-color: var(--accent); box-shadow: var(--shadow-glow); }

.mood-scale { display: flex; gap: var(--space-sm); justify-content: center; margin: var(--space-md) 0; }
.mood-scale-btn { width: 44px; height: 44px; border-radius: var(--radius-md); border: 1px solid var(--border); background: var(--bg-card); cursor: pointer; transition: all var(--transition-base); display: flex; align-items: center; justify-content: center; }
.mood-scale-btn .gradus-scale { display: flex; align-items: flex-end; gap: 2px; height: 20px; }
.mood-scale-btn .gradus-scale .gradus-bar { width: 2px; background: var(--accent); border-radius: 1px; }
.mood-scale-btn[data-mood="1"] .gradus-scale .gradus-bar:nth-child(1) { height: 4px; }
.mood-scale-btn[data-mood="1"] .gradus-scale .gradus-bar:nth-child(2) { height: 3px; }
.mood-scale-btn[data-mood="1"] .gradus-scale .gradus-bar:nth-child(3) { height: 2px; }
.mood-scale-btn[data-mood="2"] .gradus-scale .gradus-bar:nth-child(1) { height: 6px; }
.mood-scale-btn[data-mood="2"] .gradus-scale .gradus-bar:nth-child(2) { height: 5px; }
.mood-scale-btn[data-mood="2"] .gradus-scale .gradus-bar:nth-child(3) { height: 4px; }
.mood-scale-btn[data-mood="3"] .gradus-scale .gradus-bar:nth-child(1) { height: 8px; }
.mood-scale-btn[data-mood="3"] .gradus-scale .gradus-bar:nth-child(2) { height: 8px; }
.mood-scale-btn[data-mood="3"] .gradus-scale .gradus-bar:nth-child(3) { height: 8px; }
.mood-scale-btn[data-mood="4"] .gradus-scale .gradus-bar:nth-child(1) { height: 8px; }
.mood-scale-btn[data-mood="4"] .gradus-scale .gradus-bar:nth-child(2) { height: 12px; }
.mood-scale-btn[data-mood="4"] .gradus-scale .gradus-bar:nth-child(3) { height: 16px; }
.mood-scale-btn[data-mood="5"] .gradus-scale .gradus-bar:nth-child(1) { height: 12px; }
.mood-scale-btn[data-mood="5"] .gradus-scale .gradus-bar:nth-child(2) { height: 16px; }
.mood-scale-btn[data-mood="5"] .gradus-scale .gradus-bar:nth-child(3) { height: 20px; }
.mood-scale-btn.selected { border-color: var(--accent); box-shadow: var(--shadow-glow); }

/* ----------------------------------------
   17. FORMS
   ---------------------------------------- */

.form-group { margin-bottom: 1.25rem; }
.form-label { display: block; font-size: 0.6875rem; font-weight: 500; letter-spacing: 0.1em; text-transform: uppercase; color: var(--text-secondary); margin-bottom: var(--space-sm); }
.form-input, .form-textarea { width: 100%; padding: 0.875rem var(--space-md); border: 1px solid var(--border); border-radius: var(--radius-sm); font-family: 'Inter', sans-serif; font-size: 0.9375rem; font-weight: 300; color: var(--text-primary); background: var(--bg-card); transition: all var(--transition-base); }
.form-input:focus, .form-textarea:focus { outline: none; border-color: var(--accent); box-shadow: var(--shadow-glow); }
.form-textarea { min-height: 100px; resize: vertical; }
.form-input::placeholder, .form-textarea::placeholder { color: var(--text-muted); }

/* ----------------------------------------
   18. MODAL
   ---------------------------------------- */

.modal-overlay { position: fixed; inset: 0; background: rgba(26, 29, 33, 0.85); backdrop-filter: blur(4px); display: none; align-items: center; justify-content: center; z-index: var(--z-modal); padding: var(--space-lg); }
.modal-overlay.active { display: flex; }
.modal { background: var(--bg-card); border-radius: var(--radius-lg); padding: var(--space-xl); width: 100%; max-width: 320px; box-shadow: var(--shadow-elevated); border: 1px solid var(--border); animation: modalIn var(--transition-slow) ease; }
@keyframes modalIn { from { opacity: 0; transform: scale(0.95) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }
.modal-title { font-size: 1.25rem; letter-spacing: 0.15em; text-align: center; margin-bottom: var(--space-sm); }
.modal-icon { display: flex; justify-content: center; margin-bottom: var(--space-md); }
.modal-icon .gradus-confirm { display: flex; align-items: center; gap: 4px; height: 48px; }
.modal-icon .gradus-confirm .gradus-bar { width: 4px; background: var(--status-confirmed); }
.modal-icon .gradus-confirm .gradus-bar:nth-child(1) { height: 16px; }
.modal-icon .gradus-confirm .gradus-bar:nth-child(2) { height: 28px; }
.modal-icon .gradus-confirm .gradus-bar:nth-child(3) { height: 40px; }

/* ----------------------------------------
   19. BOTTOM NAVIGATION
   ---------------------------------------- */

.bottom-nav { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: var(--container-max); background: var(--bg-secondary); border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: var(--space-sm) 0; padding-bottom: calc(var(--space-sm) + env(safe-area-inset-bottom, 0)); z-index: var(--z-header); }
.nav-item { display: flex; flex-direction: column; align-items: center; gap: var(--space-xs); padding: var(--space-sm) var(--space-md); background: none; border: none; color: var(--text-muted); font-size: 0.5625rem; letter-spacing: 0.1em; text-transform: uppercase; cursor: pointer; border-radius: var(--radius-md); transition: color var(--transition-fast); }
.nav-item .nav-icon { display: flex; align-items: center; gap: 2px; height: 20px; }
.nav-item .nav-icon .gradus-bar { width: 2px; background: currentColor; border-radius: 1px; }
.nav-item .nav-icon .gradus-bar:nth-child(1) { height: 6px; }
.nav-item .nav-icon .gradus-bar:nth-child(2) { height: 10px; }
.nav-item .nav-icon .gradus-bar:nth-child(3) { height: 14px; }
.nav-item.active { color: var(--accent); }
.nav-item:hover { color: var(--accent); }

/* ----------------------------------------
   20. PRAXIS SKILLS & CALENDAR
   ---------------------------------------- */

.praxis-skills { display: flex; flex-direction: column; gap: var(--space-sm); }
.praxis-skill { padding: var(--space-sm) var(--space-md); background: var(--bg-elevated); border-radius: var(--radius-md); border-left: 3px solid var(--accent); font-size: 0.875rem; }
.praxis-skill strong { color: var(--accent); font-weight: 500; }

.progressio-calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin: var(--space-md) 0; }
.calendar-day { aspect-ratio: 1; border-radius: var(--radius-sm); background: var(--bg-card); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-family: 'Fira Code', monospace; font-size: 0.625rem; color: var(--text-muted); }
.calendar-day.completed { background: var(--accent); border-color: var(--accent); color: var(--bg-primary); }
.calendar-day.today { border-color: var(--accent); box-shadow: var(--shadow-glow); }

/* ----------------------------------------
   21. UTILITIES
   ---------------------------------------- */

.text-center { text-align: center; }
.text-left { text-align: left; }
.text-right { text-align: right; }
.mb-xs { margin-bottom: var(--space-xs); }
.mb-sm { margin-bottom: var(--space-sm); }
.mb-md { margin-bottom: var(--space-md); }
.mb-lg { margin-bottom: var(--space-lg); }
.mb-xl { margin-bottom: var(--space-xl); }
.mt-xs { margin-top: var(--space-xs); }
.mt-sm { margin-top: var(--space-sm); }
.mt-md { margin-top: var(--space-md); }
.mt-lg { margin-top: var(--space-lg); }
.mt-xl { margin-top: var(--space-xl); }
.p-md { padding: var(--space-md); }
.p-lg { padding: var(--space-lg); }
.hidden { display: none !important; }
.visually-hidden { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0, 0, 0, 0); white-space: nowrap; border: 0; }

/* ----------------------------------------
   22. RESPONSIVE
   ---------------------------------------- */

@media (max-width: 380px) {
  .header-content { flex-wrap: wrap; justify-content: center; gap: var(--space-sm); }
  .theme-label { display: none; }
  .stats-grid { grid-template-columns: repeat(3, 1fr); gap: var(--space-xs); }
  .stat-value { font-size: 1.5rem; }
}

@media print {
  .header, .bottom-nav, .modal-overlay { display: none !important; }
  .main-content { padding: 0; }
  .card { break-inside: avoid; }
}
